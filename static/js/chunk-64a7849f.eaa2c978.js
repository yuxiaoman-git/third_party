(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64a7849f"],{"0188":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-autocomplete",{style:{width:e.width},attrs:{"fetch-suggestions":e.querySearchAsync,"trigger-on-focus":!1,"popper-class":"my-autocomplete",placeholder:"请输入内容",clearable:""},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[r("span",[e._v(e._s(a))])]}}]),model:{value:e.state,callback:function(t){e.state=t},expression:"state"}})],1)},i=[],n=r("c7eb"),l=r("1da1"),s=(r("498a"),{name:"autocompleteSmart",model:{prop:"give",event:"returnBack"},props:{give:{type:String,default:function(){return""}},width:{type:String,default:function(){return"100%"}},syncDetails:{type:Boolean,default:function(){return!1}},onSuccess:{type:Function}},data:function(){return{state:""}},watch:{state:{handler:function(e){this.$emit("returnBack",e)}},give:{handler:function(e){this.state=e}}},methods:{querySearchAsync:function(e,t){var r=this;return Object(l["a"])(Object(n["a"])().mark((function a(){var i;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.trim()){a.next=3;break}return t([]),a.abrupt("return");case 3:return a.next=5,r.$store.dispatch("media/imdbSearchNameList",{wd:e});case 5:i=a.sent,i&&0===i.code&&t(i.data&&i.data||[]);case 7:case"end":return a.stop()}}),a)})))()},handleSelect:function(e){var t=this;return Object(l["a"])(Object(n["a"])().mark((function r(){return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.state=e;case 1:case"end":return r.stop()}}),r)})))()}}}),o=s,c=(r("7a4a"),r("28b3"),r("2877")),u=Object(c["a"])(o,a,i,!1,null,"a2b465e4",null);t["a"]=u.exports},"09f4":function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),Math.easeInOutQuad=function(e,t,r,a){return e/=a/2,e<1?r/2*e*e+t:(e--,-r/2*(e*(e-2)-1)+t)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function i(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function n(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(e,t,r){var l=n(),s=e-l,o=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=o;var n=Math.easeInOutQuad(c,l,s,t);i(n),c<t?a(e):r&&"function"===typeof r&&r()};u()}},"156c":function(e,t,r){},2305:function(e,t,r){},"28b3":function(e,t,r){"use strict";r("156c")},"2ee2":function(e,t,r){"use strict";r("48ed")},"33b6":function(e,t,r){},"3aa5":function(e,t,r){},"48ed":function(e,t,r){},4973:function(e,t,r){"use strict";r("3aa5")},"55bd":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["radio"===e.el?r("el-radio-group",{attrs:{disabled:e.disabled,size:"mini"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(t){return r("el-radio",{key:t.value,attrs:{disabled:t.disabled,label:t.value}},[e._v(e._s(t.label))])})),1):e._e(),"checkbox"===e.el?r("el-checkbox-group",{attrs:{size:"mini"},on:{change:e.handelChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(t){return r("el-checkbox",{key:t.value,attrs:{label:t.value,disabled:t.disabled}},[e._v(e._s(t.label))])})),1):e._e(),"select"===e.el?r("el-select",{style:{width:e.width},attrs:{filterable:"",clearable:e.clearable,disabled:e.disabled,placeholder:"请选择",loading:e.loading,multiple:e.multiple,"collapse-tags":e.collapseTags},on:{change:e.handelChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}},[t.hint?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.hint,placement:"right"}},[r("div",[e._v(e._s(t.label))])]):e._e()],1)})),1):e._e()],1)},i=[],n=r("2909"),l=r("c7eb"),s=r("1da1"),o=r("b85c"),c=(r("d81d"),r("4de4"),r("d3b7"),r("7db0"),r("caad"),r("2532"),r("99af"),r("795d")),u={name:"SelectItme",model:{prop:"give",event:"returnBack"},props:{give:{type:[Object,Array],default:function(){return null}},width:{type:String,default:function(){return"60%"}},type:{type:String,default:function(){return""}},multiple:{type:Boolean,default:function(){return!1}},collapseTags:{type:Boolean,default:function(){return!1}},disabled:{type:Boolean,default:function(){return!1}},clearable:{type:Boolean,default:function(){return!0}},platform:{type:Boolean,default:function(){return!1}},el:{type:String,default:function(){return"select"}},tab:{type:String,default:function(){return""}}},data:function(){return{options:[{value:!0,label:"是"},{value:!1,label:"否"}],loading:!1}},computed:{value:{get:function(){return this.multiple?this.give&&this.give.map((function(e){return e.value}))||[]:this.give&&this.give.value},set:function(e){if(!this.multiple){var t,r=Object(o["a"])(this.options);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.value===e)return this.$emit("returnBack",a)}}catch(n){r.e(n)}finally{r.f()}return this.$emit("returnBack",null)}var i=this.options.filter((function(t){return e.find((function(e){return t.value===e}))}));this.$emit("returnBack",i)}}},mounted:function(){this.getOptions()},methods:{getOptions:function(){var e=this;return Object(s["a"])(Object(l["a"])().mark((function t(){var r,a,i;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.options=[],r=e.type,a=e.platform,i=c["a"][r]||c["a"]["default"],e.loading=!0,t.next=6,i({type:r,platform:a});case 6:if(t.t0=t.sent,t.t0){t.next=9;break}t.t0=[];case 9:e.options=t.t0,"checkbox"===e.el&&e.$emit("renderComplete"),e.loading=!1;case 12:case"end":return t.stop()}}),t)})))()},handelChange:function(e){var t=this.options.filter((function(t){return Array.isArray(e)?e.includes(t.value):t.value==e}));this.multiple?this.$emit("change",t):this.$emit.apply(this,["change"].concat(Object(n["a"])(t)))}}},d=u,m=r("2877"),p=Object(m["a"])(d,a,i,!1,null,null,null);t["a"]=p.exports},"75e9":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));r("fb6a");var a=[{value:"REGION",label:"区域"},{value:"PCWEB",label:"平台"},{value:"IPTV",label:"IPTV"},{value:"OTT",label:"OTT"},{value:"SOTT",label:"专网OTT"},{value:"DTV",label:"数字电视"},{value:"TV",label:"电视台"},{value:"AUDIO",label:"音频平台"}],i=a.slice(1)},"7a4a":function(e,t,r){"use strict";r("2305")},"9b4c":function(e,t,r){},af91:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"space-between"},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"50px",size:"small",inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",{attrs:{label:"名称"}},[r("autocompleteSmart",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"年代"}},[r("SelectItme",{attrs:{type:"years",width:"110px"},model:{value:e.form.years,callback:function(t){e.$set(e.form,"years",t)},expression:"form.years"}})],1),r("el-form-item",{attrs:{label:"国家"}},[r("SelectItme",{attrs:{type:"region",width:"110px"},model:{value:e.form.region,callback:function(t){e.$set(e.form,"region",t)},expression:"form.region"}})],1),r("el-form-item",{attrs:{label:"类型"}},[r("SelectItme",{attrs:{type:"classify",width:"110px"},model:{value:e.form.classify,callback:function(t){e.$set(e.form,"classify",t)},expression:"form.classify"}})],1),r("el-form-item",{attrs:{label:"排序"}},[r("SelectItme",{attrs:{type:"sort",width:"110px"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),r("el-form-item",{attrs:{"label-width":"10px"}},[r("div",{staticClass:"space-between"},[r("el-button",{attrs:{type:"primary","native-type":"submit"},nativeOn:{click:function(t){return t.preventDefault(),e.handelSearch(t)}}},[e._v("查询")])],1)])],1),e.$checkPermission(["edit"])?r("div",[r("el-button",{attrs:{disabled:!e.multipleSelection.length,type:"primary"},on:{click:function(t){return e.handelInject(e.multipleSelection[0],"batch")}}},[e._v("批量注入（已选"+e._s(e.multipleSelection.length)+"条）")])],1):e._e()],1),r("el-table",{ref:"multipleTable",staticStyle:{width:"max-content"},attrs:{data:e.tableData,border:"",size:"mini"},on:{"selection-change":e.handleSelectionChange,select:e.handleSelect,"select-all":e.handleSelectAll}},[r("el-table-column",{attrs:{type:"selection",fixed:"left",selectable:e.checkboxT}}),r("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"}}),r("el-table-column",{attrs:{prop:"media_id",label:"媒体ID",width:"60"}}),r("el-table-column",{attrs:{prop:"name",label:"文件名",width:"200","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{prop:"media",label:"媒体名",width:"160","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(a.media.name))])]}}])}),r("el-table-column",{attrs:{prop:"v_codec",label:"视频编码",width:"80","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{prop:"episode",label:"分集序号",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(a.episode.serial_num))])]}}])}),r("el-table-column",{attrs:{prop:"content_type",label:"内容类型",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(e.filterItems(e.contentType,a.content_type+"").label))])]}}])}),r("el-table-column",{attrs:{prop:"pro_type",label:"版本",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(e.filterItems(e.pro_type,a.pro_type).label))])]}}])}),r("el-table-column",{attrs:{prop:"definition",label:"清晰度",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(e.filterItems(e.definition,a.definition).label))])]}}])}),r("el-table-column",{attrs:{prop:"a_codec",label:"音频编码","show-overflow-tooltip":"",width:"80"}}),r("el-table-column",{attrs:{prop:"bit_rate",label:"总码率",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(e._f("getKbps")(a.bit_rate,2)))])]}}])}),r("el-table-column",{attrs:{prop:"v_bit_rate",label:"视频码率",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(e._f("getKbps")(a.v_bit_rate,2)))])]}}])}),r("el-table-column",{attrs:{prop:"height",label:"宽高",width:"100","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(a.width+"*"+a.height))])]}}])}),r("el-table-column",{attrs:{prop:"display_aspect_ratio",label:"比例",width:"80","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{prop:"seconds",label:"片长",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(e.formatSeconds(a.seconds)))])]}}])}),r("el-table-column",{attrs:{prop:"size",label:"大小",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("span",[e._v(e._s(e._f("getfilesize")(a.size,2)))])]}}])}),r("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"160"}}),r("el-table-column",{attrs:{label:"操作",width:"220",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("div",{staticClass:"operate-btn"},[r("span",{on:{click:function(t){return e.handelPreview(a)}}},[e._v("预览")]),e.$checkPermission(["edit"])?r("span",{on:{click:function(t){return e.handelEdit(a)}}},[e._v("修改")]):e._e(),e.$checkPermission(["edit"])?r("span",{on:{click:function(t){return e.handelInject(a)}}},[e._v("发起注入")]):e._e(),e.$checkPermission(["delete"])?r("span",{on:{click:function(t){return e.handelDel(a)}}},[e._v("删除")]):e._e()])]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit,"page-sizes":[10,20,30,50,100]},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}}),e.dialogInfoVisible?r("el-dialog",{attrs:{title:"信息",visible:e.dialogInfoVisible,"close-on-click-modal":!1,top:"20px","custom-class":"custom-dialog",width:"800px"},on:{"update:visible":function(t){e.dialogInfoVisible=t}}},[r("editPageComponent",{attrs:{media_id:e.media_id,episode_id:e.episode_id,storage_id:e.storage_id,"on-success":e.onSuccess}})],1):e._e(),r("video-component",{attrs:{visible:e.dialogVisible,url:e.videoUrl},on:{"update:visible":function(t){e.dialogVisible=t}}}),e.dialogInjectVisible?r("el-dialog",{attrs:{title:e.injectType,visible:e.dialogInjectVisible,"close-on-click-modal":!1,"custom-class":"custom-dialog",width:"650px",top:"20px"},on:{"update:visible":function(t){e.dialogInjectVisible=t}}},[r("el-alert",{directives:[{name:"show",rawName:"v-show",value:e.tip,expression:"tip"}],staticClass:"mb-16",attrs:{title:e.tip,type:"warning",closable:!1,"show-icon":""}}),r("el-form",{ref:"injectRuleForm",attrs:{model:e.injectRuleForm,rules:e.injectRules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"合作商",prop:"cooperative"}},[r("div",{staticClass:"display-flex"},[r("div",{staticClass:"flex-1"},[r("SelectItme",{attrs:{type:"cooperative",width:"95%"},on:{change:e.handelChange},model:{value:e.injectRuleForm.cooperative,callback:function(t){e.$set(e.injectRuleForm,"cooperative",t)},expression:"injectRuleForm.cooperative"}})],1),r("el-button",{attrs:{disabled:e.disabled,type:"primary"},on:{click:e.handelInjectHead}},[e._v("注入剧头")])],1)]),r("el-form-item",{attrs:{label:"等级",prop:"taskLevel"}},[r("SelectItme",{attrs:{type:e.getType,width:"100%"},on:{change:e.taskLevelChange},model:{value:e.injectRuleForm.taskLevel,callback:function(t){e.$set(e.injectRuleForm,"taskLevel",t)},expression:"injectRuleForm.taskLevel"}})],1),e.isTiming?r("el-form-item",{attrs:{label:"定时时间",prop:"timing"}},[r("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions,placeholder:"选择日期时间"},model:{value:e.injectRuleForm.timing,callback:function(t){e.$set(e.injectRuleForm,"timing",t)},expression:"injectRuleForm.timing"}})],1):e._e(),e.injectRuleForm.cooperative?r("div",[r("el-form-item",{attrs:{label:"变更媒体类型"}},[r("div",{staticClass:"box"},[r("SelectItme",{attrs:{type:"classify",width:"100%",disabled:""},model:{value:e.injectRuleForm.originalCategory,callback:function(t){e.$set(e.injectRuleForm,"originalCategory",t)},expression:"injectRuleForm.originalCategory"}}),r("i",{staticClass:"el-icon-right"}),r("SelectItme",{attrs:{type:"classify",width:"100%","options-list":e.channelOptions,disabled:!e.saveFlag},model:{value:e.injectRuleForm.classify,callback:function(t){e.$set(e.injectRuleForm,"classify",t)},expression:"injectRuleForm.classify"}})],1)]),r("el-form-item",{attrs:{label:"是否付费"}},[r("SelectItme",{attrs:{type:"charge",el:"radio",width:"100%",disabled:!e.saveFlag},model:{value:e.injectRuleForm.is_charge,callback:function(t){e.$set(e.injectRuleForm,"is_charge",t)},expression:"injectRuleForm.is_charge"}})],1)],1):e._e(),e.is_set_effective_time?r("el-form-item",{attrs:{label:"有效时间",prop:"date"}},[r("el-date-picker",{staticStyle:{width:"60%"},attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeDate},model:{value:e.injectRuleForm.date,callback:function(t){e.$set(e.injectRuleForm,"date",t)},expression:"injectRuleForm.date"}}),r("el-button",{staticClass:"fr",attrs:{type:"text"},on:{click:function(t){e.show3=!e.show3}}},[e._v(e._s(e.show3?"收起":"设置"))]),r("el-collapse-transition",[r("el-card",{directives:[{name:"show",rawName:"v-show",value:e.show3,expression:"show3"}],staticStyle:{"margin-top":"10px",padding:"10px"},attrs:{shadow:"never"}},[e._l(e.episodeList,(function(t,a){return r("div",{key:a,staticClass:"transition-box space-between"},[r("div",{staticStyle:{width:"45%"}},[r("span",[e._v("从第")]),r("el-input",{directives:[{name:"enter-number",rawName:"v-enter-number",value:0,expression:"0"}],staticStyle:{width:"60px",margin:"0 4px"},attrs:{type:"text",size:"mini"},model:{value:t.start_serial_num,callback:function(r){e.$set(t,"start_serial_num",r)},expression:"item.start_serial_num"}}),r("span",[e._v("集到第")]),r("el-input",{directives:[{name:"enter-number",rawName:"v-enter-number",value:0,expression:"0"}],staticStyle:{width:"60px",margin:"0 4px"},attrs:{type:"text",size:"mini"},model:{value:t.end_serial_num,callback:function(r){e.$set(t,"end_serial_num",r)},expression:"item.end_serial_num"}}),r("span",[e._v("集")])],1),r("div",{staticStyle:{width:"55%"}},[r("el-date-picker",{staticStyle:{width:"85%"},attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.times,callback:function(r){e.$set(t,"times",r)},expression:"item.times"}}),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",size:"mini"},on:{click:function(t){return e.delectEntry(a)}}},[e._v("删除")])],1)])})),r("div",{staticClass:"transition-box",staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"success",size:"mini",plain:""},on:{click:e.handlePush}},[e._v("新增条目")]),r("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:e.postSet}},[e._v("提交")])],1)],2)],1)],1):e._e()],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogInjectVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary",disabled:!e.flag,loading:e.saveLoading},on:{click:function(t){return e.submitInject("injectRuleForm")}}},[e._v("确 定")])],1)],1):e._e(),r("batchInject",{ref:"batchInject",attrs:{"data-list":e.multipleSelection}})],1)},i=[],n=r("3835"),l=r("b85c"),s=r("c7eb"),o=r("1da1"),c=(r("d3b7"),r("a434"),r("e9c4"),r("b0c0"),r("4e82"),r("07ac"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.dialogVisible?r("el-dialog",{attrs:{title:"预览",visible:e.dialogVisible,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("div",{staticStyle:{"text-align":"center"}},[r("video",{ref:"videoElement",attrs:{controls:"",autoplay:"",width:"450px",src:e.url}},[e._v(" 您的浏览器不支持 video 标签。 ")])]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1)]):e._e()}),u=[],d=r("40b9"),m=r.n(d),p={props:{visible:{type:Boolean},url:{type:String,default:function(){return""}}},computed:{dialogVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}},isTs:{get:function(){var e=this.url.substring(this.url.lastIndexOf("."));return".ts"===e}}},data:function(){return{player:null}},watch:{dialogVisible:{handler:function(e){var t=this;this.$nextTick((function(){if(e&&t.isTs){t.player=t.createPlayer();var r=t.$refs.videoElement;t.player&&r&&(t.player.attachMediaElement(r),t.player.load(),t.player.play())}})),e||this.player_destroy()}}},mounted:function(){},methods:{createPlayer:function(){if(m.a.getFeatureList().mseLivePlayback)return m.a.createPlayer({type:"mse",isLive:!0,url:this.url})},player_destroy:function(){this.player&&(this.player.pause(),this.player.unload(),this.player.detachMediaElement(),this.player.destroy(),this.player=null)}}},f=p,h=r("2877"),b=Object(h["a"])(f,c,u,!1,null,null,null),v=b.exports,g=r("333d"),_=r("4ed3"),y=r("73e5"),w=r("7e5d"),j=r("0188"),x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-tabs",{attrs:{"before-leave":e.beforeLeave},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{name:"first"}},[r("span",{attrs:{slot:"label"},slot:"label"},[e._v("媒体信息"),r("i",{staticClass:"el-icon-arrow-right"})]),r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.ruleFormLoading,expression:"ruleFormLoading"}],ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px",size:"small"},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"媒资名称",prop:"name"}},[r("autocomplete",{attrs:{syncDetails:"","on-success":e.getSucceed},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"导演"}},[r("SelectItmeRemote",{attrs:{type:"longhair",width:"100%",remote:"",multiple:""},model:{value:e.ruleForm.director_list,callback:function(t){e.$set(e.ruleForm,"director_list",t)},expression:"ruleForm.director_list"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"编剧"}},[r("SelectItmeRemote",{attrs:{type:"longhair",width:"100%",remote:"",multiple:""},model:{value:e.ruleForm.author_list,callback:function(t){e.$set(e.ruleForm,"author_list",t)},expression:"ruleForm.author_list"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"主演"}},[r("SelectItmeRemote",{attrs:{type:"longhair",width:"100%",remote:"",multiple:""},model:{value:e.ruleForm.actor_list,callback:function(t){e.$set(e.ruleForm,"actor_list",t)},expression:"ruleForm.actor_list"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"又名"}},[r("el-input",{attrs:{maxlength:200,"show-word-limit":"",placeholder:"又名"},model:{value:e.ruleForm.alias,callback:function(t){e.$set(e.ruleForm,"alias","string"===typeof t?t.trim():t)},expression:"ruleForm.alias"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"题材",prop:"genre_list"}},[r("SelectItme",{ref:"genre",attrs:{type:"genre",multiple:"",width:"100%"},model:{value:e.ruleForm.genre_list,callback:function(t){e.$set(e.ruleForm,"genre_list",t)},expression:"ruleForm.genre_list"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"年份",prop:"year"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"year",placeholder:"选择年","value-format":"yyyy"},model:{value:e.ruleForm.year,callback:function(t){e.$set(e.ruleForm,"year",t)},expression:"ruleForm.year"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"制片国家/地区",prop:"regions"}},[r("SelectItme",{ref:"region",attrs:{type:"region",multiple:"",width:"100%"},model:{value:e.ruleForm.regions,callback:function(t){e.$set(e.ruleForm,"regions",t)},expression:"ruleForm.regions"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"语言",prop:"languages"}},[r("el-input",{attrs:{placeholder:"语言"},model:{value:e.ruleForm.languages,callback:function(t){e.$set(e.ruleForm,"languages",t)},expression:"ruleForm.languages"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"评分",prop:"douban_score"}},[r("el-input",{directives:[{name:"enter-number",rawName:"v-enter-number",value:1,expression:"1"}],attrs:{placeholder:"评分"},model:{value:e.ruleForm.douban_score,callback:function(t){e.$set(e.ruleForm,"douban_score",t)},expression:"ruleForm.douban_score"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"集数",prop:"episodes"}},[r("el-input",{directives:[{name:"enter-number",rawName:"v-enter-number",value:0,expression:"0"}],attrs:{type:"text",placeholder:"集数"},model:{value:e.ruleForm.episodes,callback:function(t){e.$set(e.ruleForm,"episodes",t)},expression:"ruleForm.episodes"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"时长",prop:"minutes"}},[r("el-input",{directives:[{name:"enter-number",rawName:"v-enter-number",value:2,expression:"2"}],attrs:{placeholder:"时长"},model:{value:e.ruleForm.minutes,callback:function(t){e.$set(e.ruleForm,"minutes",t)},expression:"ruleForm.minutes"}},[r("template",{slot:"suffix"},[e._v("分钟")])],2)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"总时长",prop:"total_minutes"}},[r("el-input",{directives:[{name:"enter-number",rawName:"v-enter-number",value:2,expression:"2"}],attrs:{placeholder:"总时长"},model:{value:e.ruleForm.total_minutes,callback:function(t){e.$set(e.ruleForm,"total_minutes",t)},expression:"ruleForm.total_minutes"}},[r("template",{slot:"suffix"},[e._v("分钟")])],2)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"上映日期",prop:"date_published"}},[r("el-input",{attrs:{placeholder:"上映日期"},model:{value:e.ruleForm.date_published,callback:function(t){e.$set(e.ruleForm,"date_published",t)},expression:"ruleForm.date_published"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"类型",prop:"classify"}},[r("SelectItme",{attrs:{type:"classify",width:"100%"},model:{value:e.ruleForm.classify,callback:function(t){e.$set(e.ruleForm,"classify",t)},expression:"ruleForm.classify"}})],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"简介"}},[r("el-input",{attrs:{type:"textarea",rows:3,placeholder:"简介",maxlength:"500","show-word-limit":""},model:{value:e.ruleForm.storyline,callback:function(t){e.$set(e.ruleForm,"storyline",t)},expression:"ruleForm.storyline"}})],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",[r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){t.preventDefault(),e.activeName="second"}}},[e._v("下一步")])],1)],1)],1)],1)],1),r("el-tab-pane",{attrs:{name:"second"}},[r("span",{attrs:{slot:"label"},slot:"label"},[e._v("分集信息"),r("i",{staticClass:"el-icon-arrow-right"})]),r("episodeInfo",{ref:"episodeInfo",attrs:{"on-success":e.success}})],1),r("el-tab-pane",{attrs:{label:"文件信息",name:"third"}},[r("span",{attrs:{slot:"label"},slot:"label"},[e._v("文件信息"),r("i",{staticClass:"el-icon-arrow-right"})]),r("fileInfo",{ref:"fileInfo",attrs:{"on-success":e.success}})],1),r("el-tab-pane",{attrs:{label:"扩展信息",name:"four"}},[r("file-info-ext-view",{ref:"fileInfoExtView",attrs:{"on-success":e.success}})],1)],1)],1)},F=[],k=(r("a9e3"),r("d81d"),r("4de4"),r("bafd")),O=r("55bd"),S=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",{attrs:{label:"媒体",prop:"name"}},[r("SelectItmeRemote",{attrs:{width:"60%",type:"checkMovie",remote:"",disabled:""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),r("el-form-item",{attrs:{label:"分集标题",prop:"title"}},[r("el-input",{staticStyle:{width:"60%"},attrs:{type:"textarea",placeholder:"分集标题",maxlength:"128","show-word-limit":""},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{attrs:{label:"第几集"}},[r("el-input",{directives:[{name:"enter-number",rawName:"v-enter-number",value:0,expression:"0"}],staticStyle:{width:"60%"},attrs:{type:"text",disabled:"",placeholder:"第几集"},model:{value:e.ruleForm.serial_num,callback:function(t){e.$set(e.ruleForm,"serial_num",t)},expression:"ruleForm.serial_num"}})],1),r("el-form-item",{attrs:{label:"海报",prop:"episode_horpic"}},[r("span",{attrs:{slot:"label"},slot:"label"},[r("span",[e._v("海报")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.ver_size,expression:"ver_size"}],staticStyle:{"line-height":"1"}},[e._v(e._s(e.ver_size))])]),r("uploadImage",{attrs:{"img-type":"horizontal"},on:{getSize:e.getSize},model:{value:e.ruleForm.episode_horpic,callback:function(t){e.$set(e.ruleForm,"episode_horpic",t)},expression:"ruleForm.episode_horpic"}})],1),r("el-form-item",{attrs:{label:"简介",prop:"storyline"}},[r("el-input",{staticStyle:{width:"60%"},attrs:{type:"textarea",placeholder:"简介",maxlength:"128","show-word-limit":""},model:{value:e.ruleForm.storyline,callback:function(t){e.$set(e.ruleForm,"storyline","string"===typeof t?t.trim():t)},expression:"ruleForm.storyline"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submitEdit("ruleForm","third")}}},[e._v("下一步")])],1)],1)],1)},$=[],I={name:null,title:"",storyline:"",id:"",serial_num:"",episode_horpic:""},E={name:"episodeInfo",components:{uploadImage:w["a"],SelectItmeRemote:_["a"]},props:{onSuccess:{type:Function}},data:function(){return{ver_size:"",ruleForm:Object.assign({},I),rules:{episode_horpic:[{required:!0,message:"请输入海报",trigger:"change"}],storyline:[{required:!0,message:"请输入简介",trigger:"change"}]},loading:!1,initBody:null}},methods:{getSize:function(e){this.ver_size=e},imdbEpisodeDetail:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function r(){var a,i,n;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={episode_id:e},t.loading=!0,r.next=4,t.$store.dispatch("injector/imdbEpisodeDetail",a);case 4:i=r.sent,t.loading=!1,t.ruleForm=Object.assign({},I),i&&0===i.code&&(n=i.data||{},t.ruleForm.id=n.id,t.ruleForm.name={value:n.media.id,label:n.media.name},t.ruleForm.serial_num=n.serial_num,t.ruleForm.episode_horpic=n.episode_horpic,t.ruleForm.storyline=n.storyline,t.ruleForm.title=n.title,t.initBody=t.getBody());case 8:case"end":return r.stop()}}),r)})))()},getBody:function(){return{media_id:this.ruleForm.name&&this.ruleForm.name.value,serial_num:this.ruleForm.serial_num,episode_horpic:this.ruleForm.episode_horpic,storyline:this.ruleForm.storyline,episode_id:this.ruleForm.id,title:this.ruleForm.title}},isEqually:function(e,t){for(var r in e)if(e[r]!==t[r])return!1;return!0},submitEdit:function(e,t){var r=this;return new Promise((function(a){r.$refs[e].validate(function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(i){var n;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i&&(n=r.getBody(),r.isEqually(r.initBody,n)||r.imdbEditEpisode(Object.assign(n,{horpic_size:r.ver_size})),t&&r.onSuccess&&r.onSuccess({next:t}),a(!0));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))},imdbEditEpisode:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function r(){return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$store.dispatch("injector/imdbEditEpisode",e);case 2:case"end":return r.stop()}}),r)})))()}}},R=E,C=Object(h["a"])(R,S,$,!1,null,null,null),T=C.exports,M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("span",[e._v(e._s(e.ruleForm.name))])]),r("el-form-item",{attrs:{label:"媒体竖图",prop:"media_verpic"}},[r("span",{attrs:{slot:"label"},slot:"label"},[r("span",[e._v("媒体竖图")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.ver_size,expression:"ver_size"}],staticStyle:{"line-height":"1"}},[e._v(e._s(e.ver_size))])]),r("uploadImage",{attrs:{"img-type":"vertical",view:!0},on:{getSize:function(t){return e.getSize("ver_size",t)}},model:{value:e.ruleForm.media_verpic,callback:function(t){e.$set(e.ruleForm,"media_verpic",t)},expression:"ruleForm.media_verpic"}})],1),r("el-form-item",{attrs:{label:"媒体横图",prop:"media_horpic"}},[r("span",{attrs:{slot:"label"},slot:"label"},[r("span",[e._v("媒体横图")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.hor_size,expression:"hor_size"}],staticStyle:{"line-height":"1"}},[e._v(e._s(e.hor_size))])]),r("uploadImage",{attrs:{"img-type":"horizontal",view:!0},on:{getSize:function(t){return e.getSize("hor_size",t)}},model:{value:e.ruleForm.media_horpic,callback:function(t){e.$set(e.ruleForm,"media_horpic",t)},expression:"ruleForm.media_horpic"}})],1),r("el-form-item",{attrs:{label:"影片等级",prop:"MediaRating"}},[r("span",[e._v(e._s(e.ruleForm.MediaRating))])]),r("el-form-item",{attrs:{label:"看点",prop:"focus"}},[r("span",[e._v(e._s(e.ruleForm.focus))])]),r("el-form-item",{attrs:{label:"审批号",prop:"approval_num"}},[r("span",[e._v(e._s(e.ruleForm.approval_num))])]),r("el-form-item",{attrs:{label:"更新频率",prop:"update_frequency"}},[r("span",[e._v(e._s(e.ruleForm.update_frequency))])]),r("el-form-item",{attrs:{label:"报备id",prop:"report_id"}},[r("span",[e._v(e._s(e.ruleForm.report_id))])]),r("el-form-item",{attrs:{label:"抢注工单id",prop:"prior_cdn_id"}},[r("span",[e._v(e._s(e.ruleForm.prior_cdn_id))])]),r("el-form-item",[r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submitEdit("ruleForm","done")}}},[e._v("完 成")])],1)],1)],1)},D=[],L=r("efeca"),q={id:"",name:null,media_verpic:"",media_horpic:"",pro_type:null,MediaRating:null,focus:"",approval_num:""},z={name:"fileInfoExt",components:{uploadImage:w["a"]},props:{onSuccess:{type:Function}},data:function(){return{ruleForm:Object.assign({},q),loading:!1,rules:{},ver_size:"",hor_size:""}},methods:{getSize:function(e,t){this[e]=t},injectorMediaExtDetail:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function r(){var a,i,l,o,c,u;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.$refs.ruleForm&&t.$refs.ruleForm.clearValidate(),a={media_id:e},t.loading=!0,r.next=5,t.$store.dispatch("injector/injectorMediaExtDetail",a);case 5:i=r.sent,t.loading=!1,t.ruleForm=Object.assign({},q),i&&0===i.code&&(l=i.data||{},t.ruleForm.id=l.id,t.ruleForm.name=l.media&&l.media.name,t.ruleForm.media_verpic=l.media_verpic?l.media_verpic:l.media_verpic1,t.ruleForm.media_horpic=l.media_horpic?l.media_horpic:l.media_horpic1,o=L["b"].filter((function(e){return e.value==l.rating})),c=Object(n["a"])(o,1),u=c[0],t.ruleForm.MediaRating=u&&u.label,t.ruleForm.focus=l.focus,t.ruleForm.approval_num=l.approval_num||"",t.ruleForm.update_frequency=l.update_frequency||"",t.ruleForm.report_id=l.report_id||"",t.ruleForm.prior_cdn_id=l.prior_cdn_id||"");case 9:case"end":return r.stop()}}),r)})))()},submitEdit:function(e,t){var r=this;return new Promise((function(e){e(!0),t&&r.onSuccess&&r.onSuccess({next:t})}))}}},P=z,B=Object(h["a"])(P,M,D,!1,null,null,null),N=B.exports,V=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("el-input",{staticStyle:{width:"60%"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name","string"===typeof t?t.trim():t)},expression:"ruleForm.name"}})],1),r("el-form-item",{attrs:{label:"内容类型",prop:"contentType"}},[r("SelectItme",{attrs:{type:"contentType",width:"60%"},model:{value:e.ruleForm.contentType,callback:function(t){e.$set(e.ruleForm,"contentType",t)},expression:"ruleForm.contentType"}})],1),r("el-form-item",{attrs:{label:"版本",prop:"pro_type"}},[r("SelectItme",{attrs:{type:"pro_type",width:"60%"},model:{value:e.ruleForm.pro_type,callback:function(t){e.$set(e.ruleForm,"pro_type",t)},expression:"ruleForm.pro_type"}})],1),r("el-form-item",{attrs:{label:"清晰度",prop:"definition"}},[r("SelectItme",{attrs:{type:"definition",width:"60%"},model:{value:e.ruleForm.definition,callback:function(t){e.$set(e.ruleForm,"definition",t)},expression:"ruleForm.definition"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.injectorStorageEdit("ruleForm","four")}}},[e._v("下一步")])],1)],1)],1)},A=[],Q={id:"",name:"",contentType:"",pro_type:"",definition:""},H={name:"fileInfo",components:{SelectItme:y["a"]},props:{onSuccess:{type:Function}},data:function(){return{ruleForm:Object.assign({},Q),loading:!1,rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],contentType:[{required:!0,message:"请选择内容类型",trigger:"change"}],pro_type:[{required:!0,message:"请选择版本",trigger:"change"}],definition:[{required:!0,message:"请选择清晰度",trigger:"change"}]},initBody:null}},methods:{injectorStorageDetail:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function r(){var a,i;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.loading=!0,r.next=3,t.$store.dispatch("injector/injectorStorageDetail",{storage_id:e});case 3:a=r.sent,t.loading=!1,t.ruleForm=Object.assign({},Q),a&&0===a.code&&(i=a.data||{},t.ruleForm.id=i.id,t.ruleForm.name=i.name,t.ruleForm.contentType=i.content_type+""||"",t.ruleForm.pro_type=i.pro_type||"",t.ruleForm.definition=i.definition||"",t.initBody=t.getBody());case 7:case"end":return r.stop()}}),r)})))()},getBody:function(){return{storage_id:this.ruleForm.id,name:this.ruleForm.name,content_type:this.ruleForm.contentType,pro_type:this.ruleForm.pro_type,definition:this.ruleForm.definition}},isEqually:function(e,t){for(var r in e)if(e[r]!==t[r])return!1;return!0},injectorStorageEdit:function(e,t){var r=this;return new Promise((function(a){r.$refs[e].validate(function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(i){var n;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!i){e.next=7;break}if(n=r.getBody(),r.isEqually(r.initBody,n)){e.next=5;break}return e.next=5,r.$store.dispatch("injector/injectorStorageEdit",n);case 5:a(!0),t&&r.onSuccess&&r.onSuccess({next:t});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}}},J=H,U=Object(h["a"])(J,V,A,!1,null,null,null),G=U.exports,W=r("ed08"),K={classify:null,author_list:[],actor_list:[],director_list:[],genre_list:null,regions:null,languages:"",alias:"",year:"",douban_score:"",episodes:"",minutes:"",total_minutes:"",date_published:"",imdb_id:"",storyline:"",name:""},X={name:"editPageComponent",components:{SelectItmeRemote:_["a"],autocomplete:k["a"],SelectItme:O["a"],episodeInfo:T,fileInfoExtView:N,fileInfo:G},props:{media_id:{type:[String,Number],default:function(){return""}},episode_id:{type:[String,Number],default:function(){return""}},storage_id:{type:[String,Number],default:function(){return""}},onSuccess:{type:Function}},data:function(){return{initBody:null,activeName:"first",ruleFormLoading:!1,ruleForm:Object.assign({},K),rules:{name:[{required:!0,message:"请输入媒资名称",trigger:"blur"}],genre_list:[{required:!0,message:"请选择题材",trigger:"change"}],year:[{required:!0,message:"请输入年份",trigger:"blur"}],regions:[{required:!0,message:"请选择制片国家/地区",trigger:"change"}],languages:[{required:!0,message:"请输入语言",trigger:"blur"}],episodes:[{required:!0,message:"请输入集数",trigger:"blur"}],minutes:[{required:!0,message:"请输入时长",trigger:"blur"}],total_minutes:[{required:!0,message:"请输入总时长",trigger:"blur"}],date_published:[{required:!0,message:"请输入上映日期",trigger:"blur"}],classify:[{required:!0,message:"请选择内容类型",trigger:"change"}]}}},computed:{getQueryId:function(){return this.$route.query.id}},watch:{activeName:{handler:function(e){"first"===e&&this.media_id?this.imdbDetail(this.media_id):"second"===e&&this.episode_id?this.$refs.episodeInfo&&this.$refs.episodeInfo.imdbEpisodeDetail(this.episode_id):"third"===e&&this.media_id?this.$refs.fileInfo&&this.$refs.fileInfo.injectorStorageDetail(this.storage_id):"four"===e&&this.media_id&&this.$refs.fileInfoExtView&&this.$refs.fileInfoExtView.injectorMediaExtDetail(this.media_id)},immediate:!0}},methods:{success:function(e){this.activeName=e.next,this.onSuccess&&this.onSuccess(e)},imdbDetail:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function r(){var a,i;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.ruleFormLoading=!0,a={media_id:e},r.next=4,t.$store.dispatch("media/imdbDetail",a);case 4:i=r.sent,t.ruleFormLoading=!1,i&&0===i.code&&(t.getRuleForm(i.data||[]),t.ruleForm.id=i.data&&i.data.id,t.initBody=t.getBody());case 7:case"end":return r.stop()}}),r)})))()},beforeLeave:function(e,t){var r=this;return new Promise(function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(a){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("first"!==t){e.next=3;break}return e.next=3,r.submitForm("ruleForm");case 3:if("second"!==t){e.next=6;break}return e.next=6,r.$refs.episodeInfo.submitEdit("ruleForm");case 6:if("third"!==t){e.next=9;break}return e.next=9,r.$refs.fileInfo.injectorStorageEdit("ruleForm");case 9:a(!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},getSucceed:function(e){this.getRuleForm(e),this.$refs.genre&&this.$refs.genre.getOptions(),this.$refs.region&&this.$refs.region.getOptions()},getRuleForm:function(e){this.ruleForm.img=e.img,this.ruleForm.name=e.name||"",this.ruleForm.director_list=e.director_list&&e.director_list.map((function(e){return Object.assign({value:e.id,label:e.name},e)})),this.ruleForm.author_list=e.author_list&&e.author_list.map((function(e){return Object.assign({value:e.id,label:e.name},e)})),this.ruleForm.actor_list=e.actor_list&&e.actor_list.map((function(e){return Object.assign({value:e.id,label:e.name},e)})),e.genre_list&&e.genre_list.length&&(this.ruleForm.genre_list=e.genre_list.map((function(e){return{value:e.id,label:e.name}}))),e.region_list&&e.region_list.length&&(this.ruleForm.regions=e.region_list.map((function(e){return{value:e.id,label:e.name}}))),this.ruleForm.languages=e.languages,this.ruleForm.alias=e.alias,this.ruleForm.year=e.year+"",this.ruleForm.douban_score=e.douban_score,this.ruleForm.episodes=e.episodes,this.ruleForm.minutes=e.minutes,this.ruleForm.total_minutes=e.total_minutes,this.ruleForm.date_published=e.date_published,this.ruleForm.imdb_id=e.imdb_id,this.ruleForm.storyline=e.storyline,this.ruleForm.classify=L["i"].filter((function(t){return t.value===e.category}))[0]},getBody:function(){return{category:this.ruleForm.classify&&this.ruleForm.classify.value,year:this.ruleForm.year,name:this.ruleForm.name,director_ids:Object(W["b"])(this.ruleForm.director_list),author_ids:Object(W["b"])(this.ruleForm.author_list),actor_ids:Object(W["b"])(this.ruleForm.actor_list),genre_ids:Object(W["b"])(this.ruleForm.genre_list),douban_score:this.ruleForm.douban_score||"",episodes:1*this.ruleForm.episodes,minutes:1*this.ruleForm.minutes,total_minutes:1*this.ruleForm.total_minutes,date_published:this.ruleForm.date_published,region_ids:Object(W["b"])(this.ruleForm.regions),languages:this.ruleForm.languages,alias:this.ruleForm.alias,imdb_id:this.ruleForm.imdb_id,storyline:this.ruleForm.storyline,media_id:this.ruleForm.id}},isEqually:function(e,t){for(var r in e)if(e[r]!==t[r])return!1;return!0},submitForm:function(e,t){var r=this;return new Promise((function(a){r.$refs[e].validate(function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(i){var n;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!i){e.next=7;break}if(n=r.getBody(),r.isEqually(r.initBody,n)){e.next=5;break}return e.next=5,r.$store.dispatch("media/imdbEdit",n);case 5:a(!0),t&&(r.activeName=t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))},imdbEdit:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function r(){var a;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$store.dispatch("media/imdbEdit",e);case 2:a=r.sent,a&&0===a.code&&(t.activeName="second",t.onSuccess&&t.onSuccess(!0));case 4:case"end":return r.stop()}}),r)})))()}}},Y=X,Z=Object(h["a"])(Y,x,F,!1,null,null,null),ee=Z.exports,te=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.isShow?r("div",[r("span",{directives:[{name:"show",rawName:"v-show",value:!e.collapse,expression:"!collapse"}],staticClass:"dot",attrs:{title:"展开"},on:{click:e.handelShow}},[r("i",{staticClass:"el-icon-full-screen"})]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.collapse,expression:"collapse"}],staticClass:"card",style:{bottom:e.uploadPanelShow?"347px":""}},[r("div",{staticClass:"title"},[r("div",{staticClass:"left"},[e._v("注入列表")]),r("div",{staticClass:"operate"},[r("el-button",{attrs:{type:"text",title:e.collapse?"展开":"折叠"},on:{click:e.handelShow}},[r("i",{staticClass:"el-icon-minus"})]),r("el-button",{attrs:{type:"text",title:"关闭"},on:{click:e.handleClose}},[r("i",{staticClass:"el-icon-close"})])],1)]),r("ul",{staticClass:"list-box"},e._l(e.list,(function(t,a){return r("li",{key:a,class:[0===t.code?"bg-succeed":0!==t.code&&void 0!==t.code?"bg-err":""]},[r("div",{staticClass:"media-title-box",on:{mouseenter:function(t){return e.handleDivMouseEnter(t)},mouseleave:function(t){return e.handleDivMouseleave(t)}}},[r("div",{staticClass:"media-title topicStyle"},[e._v(" "+e._s(t.media&&t.media.name)+"-"+e._s(t.storage_id)+"-"+e._s(t.episode&&t.episode.serial_num)+" ")])]),r("div",{staticClass:"partner-box",on:{mouseenter:function(t){return e.handleDivMouseEnter(t)},mouseleave:function(t){return e.handleDivMouseleave(t)}}},[r("div",{staticClass:"topicStyle"},[e._v(e._s(t.partner_title))])]),r("div",{staticClass:"time-box",on:{mouseenter:function(t){return e.handleDivMouseEnter(t)},mouseleave:function(t){return e.handleDivMouseleave(t)}}},[r("div",{staticClass:"topicStyle"},[e._v(e._s(t.create_time))])]),0!==t.code?r("div",{staticClass:"err-box",on:{mouseenter:function(t){return e.handleDivMouseEnter(t)},mouseleave:function(t){return e.handleDivMouseleave(t)}}},[r("div",{staticClass:"topicStyle"},[e._v(" "+e._s(t.desc)+" ")])]):e._e(),r("div",{staticClass:"btn-box"},[0===t.code?r("span",[e._v("成功")]):e._e(),0!==t.code?r("el-button",{attrs:{type:"text",loading:t.loading},on:{click:function(r){return e.retry(t)}}},[e._v("重试")]):e._e(),0!==t.code?r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.handleRemove(t,a)}}},[r("i",{staticClass:"el-icon-close"})]):e._e()],1)])})),0)]),r("el-tooltip",{ref:"tooltip",attrs:{placement:"top",content:e.tooltipContent}})],1):e._e()},re=[],ae=(r("c740"),r("5530")),ie=r("d4ec"),ne=r("bee2"),le=r("4dec"),se=new le["a"]("inject_database");se.version(1).stores({injectList:"++id,storage_id,partner_id,[storage_id+partner_id]"});var oe=se,ce=function(){function e(){Object(ie["a"])(this,e),this.db=oe&&oe.injectList}return Object(ne["a"])(e,[{key:"add",value:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t){var r;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=(new Date).getTime(),e.prev=1,e.next=4,this.db.add(Object(ae["a"])(Object(ae["a"])({},t),{},{createTime:r}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](1),console.error(e.t0);case 9:case"end":return e.stop()}}),e,this,[[1,6]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"delete",value:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t,r){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.db.where("[storage_id+partner_id]").equals([t,r]).delete();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"deleteAll",value:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.db.where("id").above(0).delete();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"deleteMessagesByMsgIds",value:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.db.where("msgId").anyOf(t).delete();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"update",value:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t,r,a){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.db.where("[storage_id+partner_id]").equals([t,r]).modify(Object(ae["a"])({},a));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t,r,a){return e.apply(this,arguments)}return t}()},{key:"updateMessagesStatus",value:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t,r){var a;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=(new Date).getTime(),e.prev=1,e.next=4,this.db.where("msgId").anyOf(t).modify({status:r,updateTime:a});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](1),console.error(e.t0);case 9:case"end":return e.stop()}}),e,this,[[1,6]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"filterMessagesByDocId",value:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t,r,a){var i;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=[],e.prev=1,e.next=4,this.db.where({docId:t}).and((function(e){return e.createTime<a&&e.createTime>r})).toArray();case 4:i=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),console.error(e.t0);case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(t,r,a){return e.apply(this,arguments)}return t}()},{key:"getAllMessagesByDocId",value:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t){var r;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=[];try{r=this.db.where({docId:t}).sortBy("createTime")}catch(a){console.error(a)}return e.abrupt("return",r);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"get",value:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t){var r=this;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){try{Object(o["a"])(Object(s["a"])().mark((function a(){var i;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,r.db.get({storage_id:t});case 2:i=a.sent,e(i);case 4:case"end":return a.stop()}}),a)})))()}catch(i){a(i)}})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"get_completed",value:function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(t){var r=this;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){try{Object(o["a"])(Object(s["a"])().mark((function a(){var i;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,r.db.where("status").equals(t).toArray();case 2:i=a.sent,e(i);case 4:case"end":return a.stop()}}),a)})))()}catch(i){a(i)}})));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getAll",value:function(){var e=this;return new Promise((function(t,r){try{Object(o["a"])(Object(s["a"])().mark((function r(){var a;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.db.where("id").above(0).toArray();case 2:a=r.sent,t(a);case 4:case"end":return r.stop()}}),r)})))()}catch(a){r(a)}}))}}]),e}(),ue=r("0e15"),de=r.n(ue),me=r("526f"),pe={props:{dataList:{type:Array,default:function(){return[]}}},data:function(){return{collapse:!0,isShow:!1,list:[],db:new ce,tooltipContent:""}},computed:{uploadPanelShow:{get:function(){return this.$store.state.uploadPanel.uploadPanelShow&&!this.$store.state.uploadPanel.expand}}},created:function(){this.activateTooltip=de()(50,(function(e){return e.handleShowPopper()}))},mounted:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var r;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.db.getAll();case 2:r=t.sent,r&&r.length&&(e.list=JSON.parse(JSON.stringify(r)),e.list.length&&(e.isShow=!0));case 4:case"end":return t.stop()}}),t)})))()},methods:{getList:function(){var e,t=this,r=JSON.parse(JSON.stringify(this.dataList)),a=Object(l["a"])(r);try{for(a.s();!(e=a.n()).done;){var i=e.value;delete i.id}}catch(c){a.e(c)}finally{a.f()}var n,s=Object(l["a"])(r);try{var o=function(){var e=n.value,r=t.list.findIndex((function(t){return t.storage_id===e.storage_id&&t.partner_id===e.partner_id}));-1===r?(t.db.add(e),t.list.push(e),t.injectorTaskAdd(e)):(t.db.update(e.storage_id,e.partner_id,e),t.list.splice(r,1,e),t.injectorTaskAdd(e))};for(s.s();!(n=s.n()).done;)o()}catch(c){s.e(c)}finally{s.f()}this.isShow||(this.isShow=!0),this.collapse||(this.collapse=!0)},handelShow:function(){this.collapse=!this.collapse},handleClose:function(){this.isShow=!1},injectorTaskAdd:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function r(){var a,i,n,l,o,c,u;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e||{},i=a.storage_id,n=a.partner_id,l=a.level,o=a.uid,c={storage_id:i,partner_id:n,level:l,uid:o},t.$set(e,"loading",!0),delete e.code,r.next=6,t.$store.dispatch("injector/injectorTaskAdd",c);case 6:u=r.sent,t.$set(e,"desc",u.desc),t.$set(e,"code",u.code),t.$set(e,"loading",!1),0===u.code&&t.db.delete(i,n);case 11:case"end":return r.stop()}}),r)})))()},retry:function(e){this.injectorTaskAdd(e)},handleRemove:function(e,t){this.list.splice(t,1),this.db.delete(e.storage_id,e.partner_id)},handleDivMouseEnter:function(e){var t=e.target,r=t.querySelector(".groupItemClass"),a=!1;r||(r=t.querySelector(".setItemClass"),r||(r=t.querySelector(".topicStyle"))),(r&&r.scrollHeight)>(r&&r.offsetHeight)&&(a=!0);var i=document.createRange();i.setStart(r,0),i.setEnd(r,r.childNodes.length);var n=i.getBoundingClientRect().width,l=(parseInt(Object(me["a"])(t,"paddingLeft"),10)||0)+(parseInt(Object(me["a"])(t,"paddingRight"),10)||0);if(n+l>t.offsetWidth||r.scrollWidth>r.offsetWidth||a&&this.$refs.tooltip){var s=this.$refs.tooltip;this.tooltipContent=t.innerText||t.textContent,s.referenceElm=t,s.$refs.popper&&(s.$refs.popper.style.display="none"),s.doDestroy(),s.setExpectedState(!0),this.activateTooltip(s)}},handleDivMouseleave:function(){var e=this.$refs.tooltip;e&&(e.setExpectedState(!1),e.handleClosePopper())}}},fe=pe,he=(r("fd4a"),Object(h["a"])(fe,te,re,!1,null,"4b3ed27d",null)),be=he.exports,ve=r("5f87"),ge=r("bec9"),_e={id:"",name:null,media_verpic:"",media_horpic:"",pro_type:null,MediaRating:null,focus:""},ye={storage_id:"",cooperative:"",taskLevel:"",serial_num:null,media_id:null,classify:"",originalCategory:"",is_charge:"",date:[],timing:""},we={name:"materialManage",components:{Pagination:g["a"],SelectItmeRemote:_["a"],SelectItme:y["a"],uploadImage:w["a"],autocompleteSmart:j["a"],editPageComponent:ee,batchInject:be,videoComponent:v},data:function(){return{saveLoading:!1,flag:!1,header_flag:!1,tip:"",show3:!1,dialogInjectVisible:!1,injectRuleForm:Object.assign({},ye),injectRules:{cooperative:[{required:!0,message:"请选择合作商",trigger:"change"}],timing:[{required:!0,message:"请选择",trigger:"change"}],date:[{required:!0,message:"请选择",trigger:"change"}],taskLevel:[{required:!0,message:"请选择等级",trigger:"change"}]},media_id:"",episode_id:"",MediaRating:L["b"],contentType:L["e"],options:L["i"],pro_type:L["k"],definition:L["f"],dialogInfoVisible:!1,form:{name:"",region:"",years:"",classify:"",sort:""},dialogVisibleEdit:!1,total:0,listQuery:{page:1,limit:20},tableData:[],ruleForm:Object.assign({},_e),rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],media_verpic:[{required:!0,message:"请选择图片",trigger:"blur"}],media_horpic:[{required:!0,message:"请选择图片",trigger:"blur"}],pro_type:[{required:!0,message:"请选择版本",trigger:"blur"}],MediaRating:[{required:!0,message:"请选择影片等级",trigger:"blur"}],focus:[{required:!0,message:"请输入看点",trigger:"blur"}]},dialogVisible:!1,videoUrl:"",episodeList:[{start_serial_num:null,end_serial_num:null,times:[]}],multipleSelection:[],injectType:"发起注入",partner_title:"",alias:"",mediaTypeErrMsg:"所选合作商不支持该媒体类型，请选择变更媒体类型",channelOptions:[],saveFlag:!1,is_set_effective_time:!1,isTiming:!1,pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}}}},computed:{disabled:function(){return!(!this.flag&&!this.header_flag&&this.injectRuleForm.cooperative)},fristItem:function(){return this.multipleSelection[0]},getType:function(){return"发起注入"==this.injectType?"taskLevel":"batchTaskLevel"}},mounted:function(){this.injectorMediaExtList()},methods:{handelChange:function(e){this.is_set_effective_time=e&&e.is_set_effective_time,this.partner_title=e&&e.label,this.alias=e&&e.alias,e?(this.injectorTaskCanAdd(),this.injected()):(this.flag=!1,this.tip=""),e&&e.is_set_effective_time&&this.imdbGetEpisodeEffectiveTime()},injected:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var r,a,i,n,l,o,c,u;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.injectRuleForm,a=r.cooperative,i=r.media_id,t.next=3,e.$store.dispatch("injector/injected",{media_id:i,partner_id:a,alias:e.alias});case 3:n=t.sent,0==n.code&&(l=n.category||{},o=l.value,c=n.is_charge||{},u=c.value,e.channelOptions=n&&n.channel||[],e.saveFlag=n.save,e.injectRuleForm.classify=o,e.injectRuleForm.is_charge=u);case 5:case"end":return t.stop()}}),t)})))()},checkMediaType:function(){var e=this.injectRuleForm,t=e.classify,r=e.originalCategory;if(!t){var a=this.channelOptions.some((function(e){return e.value==r}));return!a}},check:function(){return this.saveFlag},injected_post:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var r,a,i,n,l,o,c,u;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.injectRuleForm,a=r.cooperative,i=r.is_charge,n=r.classify,l=r.media_id,o=r.originalCategory,c=n||o,t.next=4,e.$store.dispatch("injector/injected_post",{media_id:l,partner_id:a,category:c,is_charge:i});case 4:return u=t.sent,t.abrupt("return",new Promise((function(e,t){0==u.code?e({status:"succeed"}):t({status:"failing"})})));case 6:case"end":return t.stop()}}),t)})))()},filterItems:ge["b"],formatSeconds:ge["c"],checkboxT:function(e){return!1!==e.isChecked},handleSelectionChange:function(e){this.multipleSelection=e},handleSelect:function(e,t){if(e.length){var r,a=Object(l["a"])(this.tableData);try{for(a.s();!(r=a.n()).done;){var i=r.value;i.media_id!==t.media_id&&(i.isChecked=!1)}}catch(c){a.e(c)}finally{a.f()}}else{var n,s=Object(l["a"])(this.tableData);try{for(s.s();!(n=s.n()).done;){var o=n.value;o.isChecked=!0}}catch(c){s.e(c)}finally{s.f()}}},handleSelectAll:function(e){if(e.length){var t,r=Object(n["a"])(e,1),a=r[0],i=Object(l["a"])(this.tableData);try{for(i.s();!(t=i.n()).done;){var s=t.value;s.media_id!==a.media_id&&(s.isChecked=!1,this.$refs.multipleTable.toggleRowSelection(s,!1))}}catch(d){i.e(d)}finally{i.f()}}else{var o,c=Object(l["a"])(this.tableData);try{for(c.s();!(o=c.n()).done;){var u=o.value;u.isChecked=!0}}catch(d){c.e(d)}finally{c.f()}}},changeDate:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var r,a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.injectRuleForm.date){t.next=2;break}return t.abrupt("return",e.$message.warning("日期不能为空"));case 2:return r=[{media_id:e.injectRuleForm.media_id,partner_id:e.injectRuleForm.cooperative,start_date:e.injectRuleForm.date&&e.injectRuleForm.date[0],end_date:e.injectRuleForm.date&&e.injectRuleForm.date[1],start_serial_num:1*e.injectRuleForm.serial_num,end_serial_num:1*e.injectRuleForm.serial_num}],t.next=5,e.$store.dispatch("injector/imdbSetEpisodeEffectiveTime",r);case 5:a=t.sent,a&&0===a.code?e.$message.success("设置成功"):e.$message.error("设置有效时间失败");case 7:case"end":return t.stop()}}),t)})))()},handlePush:function(){this.episodeList.push({start_serial_num:null,end_serial_num:null,times:[]})},delectEntry:function(e){this.episodeList.splice(e,1)},postSet:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var r,a,i,n,o;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=[],e.injectRuleForm.media_id){t.next=3;break}return t.abrupt("return",e.$message.warning("媒体ID不存在"));case 3:if(e.injectRuleForm.cooperative){t.next=5;break}return t.abrupt("return",e.$message.warning("合作商不存在"));case 5:if(e.episodeList.length){t.next=7;break}return t.abrupt("return");case 7:a=Object(l["a"])(e.episodeList),t.prev=8,a.s();case 10:if((i=a.n()).done){t.next=23;break}if(n=i.value,n.start_serial_num){t.next=14;break}return t.abrupt("return",e.$message.warning("开始集数不能为空"));case 14:if(n.end_serial_num){t.next=16;break}return t.abrupt("return",e.$message.warning("结束集数不能为空"));case 16:if(!(1*n.start_serial_num>1*n.end_serial_num)){t.next=18;break}return t.abrupt("return",e.$message.warning("开始集数不能大于结束集数"));case 18:if(n.times&&n.times.length){t.next=20;break}return t.abrupt("return",e.$message.warning("日期不能为空"));case 20:r.push({media_id:e.injectRuleForm.media_id,partner_id:e.injectRuleForm.cooperative,start_date:n.times[0],end_date:n.times[1],start_serial_num:n.start_serial_num,end_serial_num:n.end_serial_num});case 21:t.next=10;break;case 23:t.next=28;break;case 25:t.prev=25,t.t0=t["catch"](8),a.e(t.t0);case 28:return t.prev=28,a.f(),t.finish(28);case 31:return t.next=33,e.$store.dispatch("injector/imdbSetEpisodeEffectiveTime",r);case 33:o=t.sent,o&&0===o.code&&(e.imdbGetEpisodeEffectiveTime(),e.$message.success("设置成功"),e.show3=!1);case 35:case"end":return t.stop()}}),t,null,[[8,25,28,31]])})))()},imdbGetEpisodeEffectiveTime:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var r,a,i;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r={media_id:e.injectRuleForm.media_id,serial_num:e.injectRuleForm.serial_num,partner_id:e.injectRuleForm.cooperative},r.media_id){t.next=3;break}return t.abrupt("return",e.$message.warning("媒体ID不存在"));case 3:if(r.serial_num){t.next=5;break}return t.abrupt("return",e.$message.warning("分集不存在"));case 5:if(r.partner_id){t.next=7;break}return t.abrupt("return",e.$message.warning("合作商不能为空"));case 7:return t.next=9,e.$store.dispatch("injector/imdbGetEpisodeEffectiveTime",r);case 9:a=t.sent,e.injectRuleForm.date=[],a&&0===a.code&&(i=a.data||{},i.start_date&&i.end_date&&(e.injectRuleForm.date=[i.start_date,i.end_date]));case 12:case"end":return t.stop()}}),t)})))()},onSuccess:function(e){"done"===e.next&&(this.dialogInfoVisible=!1,this.injectorMediaExtList())},handelInject:function(e,t){var r=this;return Object(o["a"])(Object(s["a"])().mark((function a(){return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:r.injectType=t?"批量注入":"发起注入",r.injectRuleForm=JSON.parse(JSON.stringify(ye)),r.dialogInjectVisible=!0,r.isTiming=!1,r.show3=!1,r.episodeList=[{start_serial_num:null,end_serial_num:null,times:[]}],r.injectRuleForm.storage_id=e.id,r.injectRuleForm.media_name=e.media&&e.media.name,r.injectRuleForm.serial_num=e.episode&&e.episode.serial_num,r.injectRuleForm.media_id=e.media_id,r.injectRuleForm.originalCategory=e.media&&e.media.category;case 11:case"end":return a.stop()}}),a)})))()},injectorTaskCanAdd:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var r,a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.flag=!1,t.next=3,e.$store.dispatch("injector/injectorTaskCanAdd",{media_id:e.injectRuleForm.media_id,partner_id:e.injectRuleForm.cooperative});case 3:r=t.sent,0===r.code&&(a=r.data||{},e.flag=a.flag,e.header_flag=a.header_flag,e.header_flag?e.tip=a.tip:e.tip="");case 5:case"end":return t.stop()}}),t)})))()},handelInjectHead:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var r,a,i,n,l,o,c,u,d;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.is_set_effective_time){t.next=4;break}if(r=e.injectRuleForm.date,!(Array.isArray(r)&&0==r.length||null===r)){t.next=4;break}return t.abrupt("return",e.$message.warning("日期不能为空"));case 4:if(a=e.injectRuleForm.taskLevel,a){t.next=7;break}return t.abrupt("return",e.$message.error("请选择等级"));case 7:if(!e.checkMediaType()){t.next=9;break}return t.abrupt("return",e.$message.error(e.mediaTypeErrMsg));case 9:if(!e.check()){t.next=15;break}return t.next=12,e.injected_post();case 12:if(i=t.sent,"failing"!=i.status){t.next=15;break}return t.abrupt("return");case 15:return n=e.injectRuleForm,l=n.media_id,o=n.is_charge,c=e.injectRuleForm.classify,u=e.injectRuleForm.cooperative,t.next=20,e.$store.dispatch("injector/injectorSeriesPost",{media_id:l,partner_id:u,level:a,is_charge:o,category:c||void 0});case 20:d=t.sent,0===d.code&&e.injectorTaskCanAdd();case 22:case"end":return t.stop()}}),t)})))()},submitInject:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(o["a"])(Object(s["a"])().mark((function e(r){var a,i,n,o,c,u,d,m,p,f,h,b,v,g;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=25;break}if(!t.checkMediaType()){e.next=3;break}return e.abrupt("return",t.$message.error(t.mediaTypeErrMsg));case 3:if(!t.check()){e.next=9;break}return e.next=6,t.injected_post();case 6:if(a=e.sent,"failing"!=a.status){e.next=9;break}return e.abrupt("return");case 9:if(i=t.injectRuleForm,n=i.storage_id,o=i.cooperative,c=i.taskLevel,u=i.timing,d=t.partner_title,m=Object(ve["a"])("userInfo")||{},p=m.uid,"批量注入"!==t.injectType){e.next=18;break}f=Object(l["a"])(t.multipleSelection);try{for(f.s();!(h=f.n()).done;)b=h.value,b.partner_id=o,b.partner_title=d,b.level=c,b.uid=p,b.storage_id=b.id}catch(s){f.e(s)}finally{f.f()}return t.$refs.batchInject.getList(),t.dialogInjectVisible=!1,e.abrupt("return");case 18:return v={storage_id:n,partner_id:o,level:c,uid:p,datetime:u},t.saveLoading=!0,e.next=22,t.$store.dispatch("injector/injectorTaskAdd",v);case 22:g=e.sent,t.saveLoading=!1,g&&0===g.code?(t.$message.success("注入已发起"),t.dialogInjectVisible=!1):t.$message.error(g.desc);case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handelPreview:function(e){this.videoUrl=e.url,this.dialogVisible=!0},handelSearch:function(){this.listQuery.page=1,this.injectorMediaExtList()},injectorMediaSearchExt:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var r,a,i,l,o,c,u,d,m,p,f,h,b,v,g;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.form.years.split("-")||[],a=Object(n["a"])(r,2),i=a[0],l=a[1],o=e.form,c=o.name,u=o.region,d=o.classify,m=o.sort,p=e.listQuery,f=p.page,h=p.limit,b={name:c,start_year:i,end_year:l,region_id:u||void 0,category:d||void 0,sort:m||void 0,page:f,page_size:h},t.next=5,e.$store.dispatch("injector/injectorMediaSearchExt",b);case 5:v=t.sent,v&&0===v.code&&(g=v.data||{},e.tableData=g.data_list||[],e.total=g.total_page*h||0);case 7:case"end":return t.stop()}}),t)})))()},injectorMediaExtList:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var r,a,i,n,l,o,c,u,d;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=0,a=Object.values(e.form);case 1:if(!(r<a.length)){t.next=8;break}if(i=a[r],!i){t.next=5;break}return t.abrupt("return",e.injectorMediaSearchExt());case 5:r++,t.next=1;break;case 8:return n=e.listQuery,l=n.page,o=n.limit,c={page:l,page_size:o,is_show_all:1},t.next=12,e.$store.dispatch("injector/injectorStorageList",c);case 12:u=t.sent,0===u.code&&(d=u.data||{},e.tableData=d.data_list||[],e.total=d.total_page*o);case 14:case"end":return t.stop()}}),t)})))()},injectorMediaExtField:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function r(){var a;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$store.dispatch("injector/injectorMediaExtField",e);case 2:a=r.sent,0===a.code&&(t.dialogVisibleEdit=!1,t.$message.success("操作成功"),t.injectorMediaExtList());case 4:case"end":return r.stop()}}),r)})))()},injectorMediaEditMediaExtField:function(e){var t=this;return Object(o["a"])(Object(s["a"])().mark((function r(){var a;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$store.dispatch("injector/injectorMediaEditMediaExtField",e);case 2:a=r.sent,0===a.code&&(t.dialogVisibleEdit=!1,t.$message.success("操作成功"),t.injectorMediaExtList());case 4:case"end":return r.stop()}}),r)})))()},getList:function(){this.injectorMediaExtList()},handelEdit:function(e){this.dialogInfoVisible=!0,this.media_id=e.media_id,this.episode_id=e.episode_id,this.storage_id=e.id},handelDel:function(e){var t=this;this.$confirm("确认删除该媒体库文件?","提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",type:"warning"}).then(Object(o["a"])(Object(s["a"])().mark((function r(){var a;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$store.dispatch("injector/storage_delete",{storage_ids:[e.id]});case 2:a=r.sent,a&&0===a.code&&(t.$message.success("删除成功"),t.injectorMediaExtList());case 4:case"end":return r.stop()}}),r)})))).catch((function(){}))},taskLevelChange:function(e){this.isTiming=7===e.value}}},je=we,xe=(r("4973"),Object(h["a"])(je,a,i,!1,null,"30216081",null));t["default"]=xe.exports},bafd:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.querySearchAsync,"trigger-on-focus":!1,"popper-class":"my-autocomplete",placeholder:"请输入内容",clearable:"",type:"text",maxlength:100,"show-word-limit":""},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[r("div",{staticClass:"flex-box"},[r("div",{staticClass:"left"},[r("el-image",{staticStyle:{width:"40px"},attrs:{src:a.img}})],1),r("div",{staticClass:"right"},[r("div",{staticClass:"name"},[r("span",[e._v(e._s(a.title))]),r("span",{staticClass:"ml-7 gray"},[e._v(e._s(a.year))])]),r("span",{staticClass:"addr"},[e._v(e._s(a.sub_title))])])])]}}]),model:{value:e.state,callback:function(t){e.state="string"===typeof t?t.trim():t},expression:"state"}})],1)},i=[],n=r("c7eb"),l=r("1da1"),s=(r("498a"),{name:"autocomplete",model:{prop:"give",event:"returnBack"},props:{give:{type:String,default:function(){return""}},syncDetails:{type:Boolean,default:function(){return!1}},onSuccess:{type:Function}},data:function(){return{state:""}},watch:{state:{handler:function(e){this.$emit("returnBack",e)}},give:{handler:function(e){this.state=e}}},methods:{querySearchAsync:function(e,t){var r=this;return Object(l["a"])(Object(n["a"])().mark((function a(){var i;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.trim()){a.next=3;break}return t([]),a.abrupt("return");case 3:return a.next=5,r.$store.dispatch("media/imdbSearchDouban",{wd:e});case 5:i=a.sent,i&&0===i.code&&t(i.data||[]);case 7:case"end":return a.stop()}}),a)})))()},handleSelect:function(e){var t=this;return Object(l["a"])(Object(n["a"])().mark((function r(){var a;return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.state=e.title,!t.syncDetails){r.next=6;break}return r.next=4,t.$store.dispatch("media/imdbDetailDouban",{douban_id:e.id});case 4:a=r.sent,a&&0===a.code&&t.onSuccess&&t.onSuccess(a.data||{});case 6:case"end":return r.stop()}}),r)})))()}}}),o=s,c=(r("f751"),r("2ee2"),r("2877")),u=Object(c["a"])(o,a,i,!1,null,"52111008",null);t["a"]=u.exports},bec9:function(e,t,r){"use strict";r.d(t,"e",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return s}));r("4de4"),r("d3b7"),r("99af");function a(){return"mobile"===this.$store.getters.device?"0px":this.$store.getters.sidebar.opened?"210px":"54px"}var i={region:"oss-cn-hangzhou",bucket:"senyu-img"};function n(e,t){var r=e.filter((function(e){return e.value===t}));return r.length?r[0]:{}}function l(e){var t=parseInt(e),r=Math.floor(t/3600)<10?"0"+Math.floor(t/3600):Math.floor(t/3600),a=Math.floor(t/60%60)<10?"0"+Math.floor(t/60%60):Math.floor(t/60%60),i=Math.floor(t%60)<10?"0"+Math.floor(t%60):Math.floor(t%60),n="";return n+="".concat(r,":"),n+="".concat(a,":"),n+="".concat(i),n}function s(e){if(!e)return"";var t=new Image;return t.src=e,new Promise((function(e){if(t.complete){var r=t.width,a=t.height,i="".concat(r,"x").concat(a);e({size:i,width:r,height:a})}else t.onload=function(){var r=t.width,a=t.height,i="".concat(r,"x").concat(a);e({size:i,width:r,height:a})},t.onerror=function(){e()}}))}},efeca:function(e,t,r){"use strict";r.d(t,"i",(function(){return a})),r.d(t,"k",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return l})),r.d(t,"e",(function(){return s})),r.d(t,"f",(function(){return o})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"g",(function(){return d})),r.d(t,"j",(function(){return m})),r.d(t,"h",(function(){return b})),r.d(t,"l",(function(){return v}));var a=[{value:"movie",label:"电影"},{value:"tvseries",label:"电视剧"},{value:"animation",label:"动漫"},{value:"animation_movie",label:"动漫电影"},{value:"web_movie",label:"网络电影"},{value:"sport",label:"体育"},{value:"travel",label:"旅游"},{value:"web_tv",label:"网剧"},{value:"variety",label:"综艺"},{value:"education",label:"教育"},{value:"mother_baby",label:"母婴"},{value:"game",label:"游戏"},{value:"short_film",label:"短片"},{value:"documentary",label:"纪录片"},{value:"square_dance",label:"广场舞"},{value:"SPECIAL_COLUMN",label:"专栏题目"},{value:"children",label:"儿童"},{value:"opera",label:"戏曲"},{value:"LIFE",label:"生活"},{value:"FILM",label:"影视"}],i=[{value:"剧场版",label:"剧场版"},{value:"TV版",label:"TV版"},{value:"真人版",label:"真人版"},{value:"DVD版",label:"DVD版"}],n=[{value:"Ⅰ",label:"适合任何年龄的人观看"},{value:"Ⅱ",label:"13岁以下不宜观看"},{value:"ⅡA",label:"13岁以下，建议有家长陪同观看"},{value:"ⅡB",label:"18岁以下，建议有家长陪同观看"},{value:"Ⅲ",label:"18岁以上"}],l=[{value:1,label:"仅包含H.264"},{value:2,label:"仅包含H.265"},{value:3,label:"包含H.264和H.265"}],s=[{value:"1",label:"正片"},{value:"2",label:"片花"},{value:"3",label:"预告片"},{value:"4",label:"其他"}],o=[{value:2,label:"流畅 320P"},{value:3,label:"标清 480P"},{value:4,label:"高清 720P"},{value:5,label:"全高清 1080P"},{value:10,label:"蓝光 4K"}],c=[{value:1,label:"转码已发起"},{value:2,label:"转码中"},{value:3,label:"转码完成"},{value:4,label:"转码失败",refill:!0},{value:11,label:"介质注入已发起"},{value:12,label:"介质注入中"},{value:13,label:"介质注入完成"},{value:14,label:"介质注入失败",refill:!0},{value:21,label:"信息注入已发起"},{value:22,label:"信息注入中"},{value:23,label:"信息注入完成"},{value:24,label:"信息注入失败",refill:!0}],u=[{value:"Provider",label:"卖方"},{value:"Customer",label:"买方"}],d=[{value:"Provider",label:"上游"},{value:"Customer",label:"下游"},{value:"Both",label:"上下游"}],m=[{value:1,label:"重要"},{value:3,label:"正常"},{value:4,label:"暂缓"}],p={only:[{label:"第几集",key:"start",prop:"start",value:""},{label:"总集数",key:"total",value:"1",hidden:!0}],double:[{label:"开始集数",key:"start",prop:"start",value:""},{label:"总集数",key:"total",prop:"total",value:""}],pattern:[{label:"多集创建",key:"double"},{label:"单集创建",key:"only"}]},f={only:[{label:"开始集数",key:"start",value:"1",disabled:!0},{label:"总集数",key:"total",value:"1",disabled:!0}],pattern:[{label:"单集创建",key:"only"}]},h={only:[{label:"第几期",key:"start",prop:"start",value:""},{label:"总期数",key:"total",value:"1",hidden:!0}],pattern:[{label:"单集创建",key:"only"}]},b={tvseries:p,animation:p,web_tv:p,movie:f,animation_movie:f,web_movie:f,variety:h,sport:p,travel:p,education:p,mother_baby:p,game:p,short_film:p,documentary:p,square_dance:p,SPECIAL_COLUMN:p,children:p},v=[{value:1,label:"是"},{value:0,label:"否"},{value:2,label:"未知"}]},f751:function(e,t,r){"use strict";r("33b6")},fd4a:function(e,t,r){"use strict";r("9b4c")}}]);